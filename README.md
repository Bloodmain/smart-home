# Домашнее задание №6: Контроллер умного дома

Начиная с лекции 6 все домашние задания выполняются в рамках проекта: "Контроллер умного дома".
Каждая следующая работа является продолжением предыдущей либо будет использоваться в этом проекте.

Контроллер умного дома это сервис, который предоставляет интерфейс для мониторинга состояния систем дома.  
Он принимает информацию от датчиков, сохраняет ее, может отдать информацию по запросу.  
Мы умышленно упростили некоторую логику этого сервиса, например функционал контроллера ограничен только работой с датчиками двух типов:
- `ContactClosure` - сухие контакты (датчик протечки, переключатель на замыкание или размыкание). 
Обычно события приходят при изменении состоянии датчика. Например, при открытии двери или окна.
- `ADC` - аналоговый вход (термометры, датчики уровней). Обычно события приходят при изменении показаний датчика. 
Например, при изменении показаний датчика температуры или влажности.

## Задание
Реализовать скелет сервиса и базовую функциональность используя принципы чистой архитектуры.

## Функциональные требования
При реализации задачи вы должны реализовать следующие функциональные требования:
- [ ] реализовать функцию создания пользователя;
- [ ] реализовать функцию регистрации датчиков:
  - функция регистрации идемпотентна, то есть регистрация уже зарегистрированного датчика не приводит к ошибке, но и не приводит к созданию нового датчика;
- [ ] реализовать функцию приема событий от датчиков:
  - события принимаются только от зарегистрированных датчиков;
- [ ] реализовать функцию получения информации о датчике и его состоянии;
- [ ] реализовать функцию привязки датчика к пользователю:
  - доступ к датчикам могут иметь несколько пользователей;
- [ ] реализовать функцию получения списка датчиков для пользователя;
- [ ] реализовать функцию получения списка всех датчиков;
- [ ] предусмотреть возможность работы функций в многопоточном режиме.

## Технические требования
Структура пользователя должна содержать следующие поля:
- уникальный идентификатор пользователя - `int64`;
- имя пользователя - `string`;

Структура датчика должна содержать следующие поля:
- уникальный идентификатор датчика - `int64`;
- уникальный серийный номер датчика - `string`, при регистрации сообщается датчиком, 10 цифр, могут быть ведущие нули;
- тип датчика enum:
  - `ContactClosure` - сухие контакты (датчик протечки, переключатель на замыкание или размыкание);
  - `ADC` - аналоговый вход (термометры, датчики уровней);
- состояние датчика - `int64`:
  - для `ContactClosure` 0 - разомкнуто, 1 замкнуто;
  - для `ADC` знаковое число, значение х 100 (целое);
- описание датчика - `string`, при регистрации пустое, заполняется пользователем в дальнейшем;
- признак активности датчика - `bool`, признак активности по умолчанию true;
- дата и время регистрации - `time.Time`
- дата и время последнего выхода на связь - `time.Time`

Структура события должна содержать следующие поля:
- дата и время события - `time.Time`, устанавливается во время приема;
- датчик, от которого пришло событие - `int64`;
- данные события - `int64`:
  - для `ContactClosure` - `int64` - 0 - разомкнуто, 1 - замкнуто;
  - для `ADC` - `int64` - знаковое число, значение х 100 (целое);

Структура привязки датчика к пользователю должна содержать следующие поля:
- идентификатор пользователя - `int64`;
- идентификатор датчика - `int64`;

Все данные хранятся в сервисе в памяти в любой подходящей структуре.

## Критерии оценки
Критерии оценки заданий описаны на edu

## Запуск тестов

1. зайти в терминале в каталог с домашним заданием
2. вызвать ```go test -v ./... -race```

## Запуск линтера

Для линтинга используется [golangci-lint](https://golangci-lint.run/).
Инструкцию по установке можно найти [тут](https://golangci-lint.run/usage/install/).

Для запуска линтера нужно выполнить команду `golangci-lint run` в корне проекта.
Большую часть ошибок линтера можно поправить с использованием флага `--fix`.

## Обратите внимание
От того как вы выполните это задание зависит и то, как ваш проект будет продвигаться в дальнейшем. Если вы в чем-то сомневаетесь, то не стесняйтесь задавать вопросы.